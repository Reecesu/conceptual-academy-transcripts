<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>: Hi Alia. I need to learn about functional groups... - Conceptual Academy</title>
    <style>
        :root {
            --student-color: #E3F2FD;
            --student-text: #0D47A1;
            --assistant-color: #FFFFFF;
            --assistant-text: #333333;
            --background: #f5f5f5;
            --header: #2c3e50;
            --accent: #4CAF50;
            --button-primary: #4CAF50;
            --button-secondary: #607D8B;
            --button-danger: #F44336;
            --button-text: #FFFFFF;
            --input-border: #DDDDDD;
            --modal-bg: #FFFFFF;
            --overlay: rgba(0, 0, 0, 0.5);
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            color: #333;
            background-color: var(--background);
        }
        
        header {
            background-color: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            position: relative;
        }
        
        h1 {
            color: var(--header);
            margin-top: 0;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
        }
        
        .meta {
            color: #666;
            font-size: 0.9em;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
        }
        
        .meta p {
            margin: 5px 0;
        }
        
        .chat-container {
            display: flex;
            flex-direction: column;
        }
        
        .message {
            margin-bottom: 25px;
            padding: 15px;
            border-radius: 12px;
            max-width: 85%;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            position: relative;
            animation: fadeIn 0.3s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .message::after {
            content: '';
            position: absolute;
            bottom: -10px;
            width: 0;
            height: 0;
            border: 10px solid transparent;
        }
        
        .user {
            align-self: flex-end;
            background-color: var(--student-color);
            color: var(--student-text);
        }
        
        .user::after {
            right: 15px;
            border-top-color: var(--student-color);
            border-bottom: 0;
        }
        
        .assistant {
            align-self: flex-start;
            background-color: var(--assistant-color);
            color: var(--assistant-text);
        }
        
        .assistant::after {
            left: 15px;
            border-top-color: var(--assistant-color);
            border-bottom: 0;
        }
        
        .role {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 0.9em;
            color: #777;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .content {
            white-space: pre-wrap;
        }
        
        .content p {
            margin: 0 0 15px 0;
        }
        
        .content p:last-child {
            margin-bottom: 0;
        }
        
        .reference {
            background-color: #FFFDE7;
            padding: 10px;
            border-left: 3px solid #FFC107;
            margin: 10px 0;
            font-size: 0.9em;
        }
        
        .code-block {
            background-color: #f4f4f4;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            font-family: monospace;
            overflow-x: auto;
        }
        
        .edit-buttons {
            display: flex;
            gap: 10px;
        }
        
        .edit-button, .save-button, .cancel-button, .add-button, .export-button {
            border: none;
            border-radius: 4px;
            padding: 5px 10px;
            cursor: pointer;
            font-size: 0.85em;
            transition: background-color 0.3s, transform 0.2s;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .edit-button {
            background-color: var(--button-secondary);
            color: var(--button-text);
        }
        
        .save-button {
            background-color: var(--button-primary);
            color: var(--button-text);
        }
        
        .cancel-button {
            background-color: var(--button-danger);
            color: var(--button-text);
        }
        
        .add-button, .export-button {
            background-color: var(--button-primary);
            color: var(--button-text);
            padding: 8px 16px;
            font-size: 1em;
            margin-left: auto;
        }
        
        .export-button {
            background-color: var(--button-secondary);
            margin-right: 10px;
        }
        
        button:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }
        
        button:active {
            transform: translateY(1px);
        }
        
        [contenteditable="true"] {
            border: 1px solid var(--input-border);
            padding: 10px;
            border-radius: 6px;
            outline: none;
            background-color: rgba(255, 255, 255, 0.5);
        }
        
        .editing {
            border: 2px solid var(--accent);
            background-color: rgba(255, 255, 255, 0.8);
        }
        
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--overlay);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal {
            background-color: var(--modal-bg);
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            max-width: 500px;
            width: 100%;
        }
        
        .modal h2 {
            margin-top: 0;
            color: var(--header);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }
        
        .form-group select, .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--input-border);
            border-radius: 4px;
            font-family: inherit;
            font-size: 1em;
        }
        
        .form-group textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        .modal-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }
        
        .controls {
            display: flex;
            margin-bottom: 20px;
            justify-content: flex-end;
        }
        
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 15px 25px;
            background-color: var(--accent);
            color: white;
            border-radius: 5px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
            transform: translateY(100px);
            opacity: 0;
            transition: transform 0.3s, opacity 0.3s;
            z-index: 1001;
        }
        
        .notification.show {
            transform: translateY(0);
            opacity: 1;
        }
        
        footer {
            text-align: center;
            margin-top: 30px;
            color: #777;
            font-size: 0.8em;
            padding: 10px;
            border-top: 1px solid #eee;
        }
        
        @media (prefers-color-scheme: dark) {
            :root {
                --student-color: #1A3F6C;
                --student-text: #E3F2FD;
                --assistant-color: #2A2A2A;
                --assistant-text: #FAFAFA;
                --background: #121212;
                --header: #81D4FA;
                --accent: #66BB6A;
                --button-primary: #66BB6A;
                --button-secondary: #78909C;
                --button-danger: #EF5350;
                --button-text: #FAFAFA;
                --input-border: #444444;
                --modal-bg: #2A2A2A;
                --overlay: rgba(0, 0, 0, 0.7);
            }
            
            body {
                color: #FAFAFA;
            }
            
            header {
                background-color: #2A2A2A;
            }
            
            .code-block {
                background-color: #1E1E1E;
                color: #E0E0E0;
            }
            
            .reference {
                background-color: #2C2A13;
                border-left-color: #B3912F;
            }
            
            [contenteditable="true"] {
                background-color: rgba(55, 55, 55, 0.5);
            }
            
            .editing {
                background-color: rgba(55, 55, 55, 0.8);
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>Conceptual Academy Transcript</h1>
        <div class="meta">
            <p><strong>Class ID:</strong> conceptual-chemistry-1203</p>
            <p><strong>UUID:</strong> 42de6a7d-6385-4216-9b07-f7fe7fb021d8</p>
            <p><strong>Date:</strong> 2025-03-21 06:33:16 UTC</p>
        </div>
    </header>
    
    <div class="controls">
        <button class="export-button" id="exportButton">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="7 10 12 15 17 10"></polyline>
                <line x1="12" y1="15" x2="12" y2="3"></line>
            </svg>
            Export JSON
        </button>
        <button class="add-button" id="addMessageButton">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
            Add Message
        </button>
    </div>
    
    <div class="chat-container" id="chatContainer">

        <div class="message assistant" data-index="0" data-role="assistant">
            <div class="role">
                <span>Alia</span>
                <div class="edit-buttons">
                    <button class="edit-button" onclick="editMessage(0)">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        Edit
                    </button>
                </div>
            </div>
            <div class="content" id="content-0"><p>Welcome to Conceptual Academy! I'm Alia, and I'm here to support the learning of core science concepts. Let's get started. How can I help you today?</p></div>
        </div>

        <div class="message user" data-index="1" data-role="user">
            <div class="role">
                <span>Student</span>
                <div class="edit-buttons">
                    <button class="edit-button" onclick="editMessage(1)">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        Edit
                    </button>
                </div>
            </div>
            <div class="content" id="content-1"><p>Hi Alia. I need to learn about functional groups in organic chemistry for my class. I've always struggled with chemistry in high school, so I'm a bit nervous about this topic.</p></div>
        </div>

        <div class="message assistant" data-index="2" data-role="assistant">
            <div class="role">
                <span>Alia</span>
                <div class="edit-buttons">
                    <button class="edit-button" onclick="editMessage(2)">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        Edit
                    </button>
                </div>
            </div>
            <div class="content" id="content-2"><p>I understand that feeling, and I'm here to help you build confidence in this area. Let's explore functional groups together. In organic chemistry, we start with hydrocarbons - molecules made of carbon and hydrogen atoms. Carbon atoms can bond to one another and to hydrogen atoms in many ways, which results in an incredibly large number of hydrocarbons. But what makes organic chemistry even more diverse is that carbon atoms can bond to atoms of other elements as well.</p></div>
        </div>

        <div class="message user" data-index="3" data-role="user">
            <div class="role">
                <span>Student</span>
                <div class="edit-buttons">
                    <button class="edit-button" onclick="editMessage(3)">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        Edit
                    </button>
                </div>
            </div>
            <div class="content" id="content-3"><p>So it's not just carbon and hydrogen in organic molecules?</p></div>
        </div>

        <div class="message assistant" data-index="4" data-role="assistant">
            <div class="role">
                <span>Alia</span>
                <div class="edit-buttons">
                    <button class="edit-button" onclick="editMessage(4)">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        Edit
                    </button>
                </div>
            </div>
            <div class="content" id="content-4"><p>That's right! In organic chemistry, any atom other than carbon or hydrogen in an organic molecule is called a heteroatom. The prefix "hetero-" means "different from either carbon or hydrogen."</p></div>
        </div>

        <div class="message user" data-index="5" data-role="user">
            <div class="role">
                <span>Student</span>
                <div class="edit-buttons">
                    <button class="edit-button" onclick="editMessage(5)">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        Edit
                    </button>
                </div>
            </div>
            <div class="content" id="content-5"><p>Heteroatom... so that would be like oxygen, nitrogen, or other elements that aren't carbon or hydrogen?</p></div>
        </div>

        <div class="message assistant" data-index="6" data-role="assistant">
            <div class="role">
                <span>Alia</span>
                <div class="edit-buttons">
                    <button class="edit-button" onclick="editMessage(6)">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        Edit
                    </button>
                </div>
            </div>
            <div class="content" id="content-6"><p>Exactly! You've got it. A hydrocarbon structure can serve as a framework for the attachment of various heteroatoms. This is analogous to a Christmas tree's serving as the scaffolding on which ornaments are hung. Just as the ornaments give character to the tree, heteroatoms give character to an organic molecule. These heteroatoms have profound effects on the properties of an organic molecule.</p></div>
        </div>

        <div class="message user" data-index="7" data-role="user">
            <div class="role">
                <span>Student</span>
                <div class="edit-buttons">
                    <button class="edit-button" onclick="editMessage(7)">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        Edit
                    </button>
                </div>
            </div>
            <div class="content" id="content-7"><p>Can you give me an example of how a heteroatom changes a molecule? It's hard for me to visualize what that means in practice.</p></div>
        </div>

        <div class="message assistant" data-index="8" data-role="assistant">
            <div class="role">
                <span>Alia</span>
                <div class="edit-buttons">
                    <button class="edit-button" onclick="editMessage(8)">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        Edit
                    </button>
                </div>
            </div>
            <div class="content" id="content-8"><p>Of course. Consider ethane, C₂H₆, and ethanol, C₂H₆O. They differ from each other by only a single oxygen atom. Ethane has a boiling point of -88°C, making it a gas at room temperature, and it does not dissolve in water very well. Ethanol, by contrast, has a boiling point of +78°C, making it a liquid at room temperature. It is infinitely soluble in water, and it is the active ingredient of alcoholic beverages.</p></div>
        </div>

        <div class="message user" data-index="9" data-role="user">
            <div class="role">
                <span>Student</span>
                <div class="edit-buttons">
                    <button class="edit-button" onclick="editMessage(9)">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        Edit
                    </button>
                </div>
            </div>
            <div class="content" id="content-9"><p>Wow, so just adding one oxygen atom can change a gas into a liquid? That's a bigger difference than I expected.</p></div>
        </div>

        <div class="message assistant" data-index="10" data-role="assistant">
            <div class="role">
                <span>Alia</span>
                <div class="edit-buttons">
                    <button class="edit-button" onclick="editMessage(10)">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        Edit
                    </button>
                </div>
            </div>
            <div class="content" id="content-10"><p>Yes, the impact can be dramatic! Consider further ethylamine, C₂H₇N, which has a nitrogen atom on the same basic two-carbon framework. This compound is a corrosive, pungent, highly toxic gas—most unlike either ethane or ethanol.</p></div>
        </div>

        <div class="message user" data-index="11" data-role="user">
            <div class="role">
                <span>Student</span>
                <div class="edit-buttons">
                    <button class="edit-button" onclick="editMessage(11)">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        Edit
                    </button>
                </div>
            </div>
            <div class="content" id="content-11"><p>So ethane, ethanol, and ethylamine all have basically the same carbon structure, but they act completely differently because of the different atoms attached to them?</p></div>
        </div>

        <div class="message assistant" data-index="12" data-role="assistant">
            <div class="role">
                <span>Alia</span>
                <div class="edit-buttons">
                    <button class="edit-button" onclick="editMessage(12)">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        Edit
                    </button>
                </div>
            </div>
            <div class="content" id="content-12"><p>That's precisely correct. These vast differences exist because of the different heteroatoms they contain. In organic chemistry, it's common for organic chemists to use the letter R to indicate an unspecified hydrocarbon coming off a functional group. For example, an alcohol can be indicated as R—OH, while an ether can be indicated as R—O—R. The R could equal a methyl group, —CH₃, an ethyl group, —CH₂CH₃, or any other group of carbon atoms.</p></div>
        </div>

        <div class="message user" data-index="13" data-role="user">
            <div class="role">
                <span>Student</span>
                <div class="edit-buttons">
                    <button class="edit-button" onclick="editMessage(13)">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        Edit
                    </button>
                </div>
            </div>
            <div class="content" id="content-13"><p>I think I get it. So R is just a placeholder for whatever carbon chain might be there?</p></div>
        </div>

        <div class="message assistant" data-index="14" data-role="assistant">
            <div class="role">
                <span>Alia</span>
                <div class="edit-buttons">
                    <button class="edit-button" onclick="editMessage(14)">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        Edit
                    </button>
                </div>
            </div>
            <div class="content" id="content-14"><p>Yes, that's a good way to think about it. Now, organic molecules are classified according to the functional groups they contain. We define a functional group as a combination of atoms that behave as a single unit. Most functional groups are distinguished by the heteroatoms they contain.</p></div>
        </div>

        <div class="message user" data-index="15" data-role="user">
            <div class="role">
                <span>Student</span>
                <div class="edit-buttons">
                    <button class="edit-button" onclick="editMessage(15)">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        Edit
                    </button>
                </div>
            </div>
            <div class="content" id="content-15"><p>So what are some common functional groups? I've heard of alcohols, but I'm not sure what makes something an alcohol.</p></div>
        </div>

        <div class="message assistant" data-index="16" data-role="assistant">
            <div class="role">
                <span>Alia</span>
                <div class="edit-buttons">
                    <button class="edit-button" onclick="editMessage(16)">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        Edit
                    </button>
                </div>
            </div>
            <div class="content" id="content-16"><p>There are several common functional groups in organic molecules. For alcohols, the functional group is the hydroxyl group, which is an oxygen atom bonded to a hydrogen atom (—OH). Other examples include:</p><br><p>- Ethers, which have an oxygen connecting two carbon groups (R—O—R)<br>- Amines, which contain a nitrogen atom connected to carbon atoms and hydrogen atoms<br>- Aldehydes and ketones, which contain a carbon-oxygen double bond (C=O)<br>- Carboxylic acids, which have the —COOH group<br>- Esters, which are derived from carboxylic acids and alcohols</p><br><p>When an organic chemist looks at an organic molecule, the first thing they look for are the various functional groups that the organic molecule may contain. This helps them to quickly classify the molecule and to ascertain the various physical, chemical, and even biological properties it might have.</p></div>
        </div>

        <div class="message user" data-index="17" data-role="user">
            <div class="role">
                <span>Student</span>
                <div class="edit-buttons">
                    <button class="edit-button" onclick="editMessage(17)">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        Edit
                    </button>
                </div>
            </div>
            <div class="content" id="content-17"><p>That seems like a lot to learn! How am I supposed to remember all these different groups?</p></div>
        </div>

        <div class="message assistant" data-index="18" data-role="assistant">
            <div class="role">
                <span>Alia</span>
                <div class="edit-buttons">
                    <button class="edit-button" onclick="editMessage(18)">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        Edit
                    </button>
                </div>
            </div>
            <div class="content" id="content-18"><p>Don't worry - we'll take it step by step. The remainder of this material introduces these classes of organic molecules. The role heteroatoms play in determining the properties of each class is the underlying theme. As you study this material, focus on understanding the chemical and physical properties of the various classes of compounds. This will give you a greater appreciation of the remarkable diversity of organic molecules and their many applications.</p></div>
        </div>

        <div class="message user" data-index="19" data-role="user">
            <div class="role">
                <span>Student</span>
                <div class="edit-buttons">
                    <button class="edit-button" onclick="editMessage(19)">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        Edit
                    </button>
                </div>
            </div>
            <div class="content" id="content-19"><p>So if I understand how the heteroatoms affect the properties, then I can make better sense of why organic molecules behave the way they do?</p></div>
        </div>

        <div class="message assistant" data-index="20" data-role="assistant">
            <div class="role">
                <span>Alia</span>
                <div class="edit-buttons">
                    <button class="edit-button" onclick="editMessage(20)">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        Edit
                    </button>
                </div>
            </div>
            <div class="content" id="content-20"><p>That's absolutely right! While the chemistry of hydrocarbons is interesting, when you start adding heteroatoms to these organic molecules, the chemistry becomes extraordinarily interesting. In fact, the organic chemicals of living organisms all contain heteroatoms.</p></div>
        </div>

        <div class="message user" data-index="21" data-role="user">
            <div class="role">
                <span>Student</span>
                <div class="edit-buttons">
                    <button class="edit-button" onclick="editMessage(21)">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        Edit
                    </button>
                </div>
            </div>
            <div class="content" id="content-21"><p>Oh, so that's why this matters for biology too? I'm actually more interested in biology than chemistry, so that makes this seem more relevant.</p></div>
        </div>

        <div class="message assistant" data-index="22" data-role="assistant">
            <div class="role">
                <span>Alia</span>
                <div class="edit-buttons">
                    <button class="edit-button" onclick="editMessage(22)">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        Edit
                    </button>
                </div>
            </div>
            <div class="content" id="content-22"><p>Yes! That's an excellent connection. The significance of heteroatoms in an organic molecule is that they largely determine an organic molecule's physical and chemical properties. And these properties are crucial in biological systems. Your body is full of organic molecules with various functional groups performing specific tasks based on their chemical properties.</p></div>
        </div>

        <div class="message user" data-index="23" data-role="user">
            <div class="role">
                <span>Student</span>
                <div class="edit-buttons">
                    <button class="edit-button" onclick="editMessage(23)">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        Edit
                    </button>
                </div>
            </div>
            <div class="content" id="content-23"><p>That makes more sense now. So by learning about functional groups, I'm actually learning about why biological molecules work the way they do. I'm still nervous about all the details, but at least I can see why this matters.</p></div>
        </div>

        <div class="message assistant" data-index="24" data-role="assistant">
            <div class="role">
                <span>Alia</span>
                <div class="edit-buttons">
                    <button class="edit-button" onclick="editMessage(24)">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        Edit
                    </button>
                </div>
            </div>
            <div class="content" id="content-24"><p>That's a great attitude! Understanding the "why" behind the concepts often makes learning the details much easier. Would you like to explore any specific functional group in more detail, or shall we continue with the overview of organic molecule classifications?</p></div>
        </div>

        <div class="message user" data-index="25" data-role="user">
            <div class="role">
                <span>Student</span>
                <div class="edit-buttons">
                    <button class="edit-button" onclick="editMessage(25)">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        Edit
                    </button>
                </div>
            </div>
            <div class="content" id="content-25"><p>I think I'm starting to get comfortable with the basic idea of functional groups. Could we go over alcohols a bit more? Since you mentioned ethanol earlier, and that's something I'm familiar with.</p></div>
        </div>

        <div class="message assistant" data-index="26" data-role="assistant">
            <div class="role">
                <span>Alia</span>
                <div class="edit-buttons">
                    <button class="edit-button" onclick="editMessage(26)">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        Edit
                    </button>
                </div>
            </div>
            <div class="content" id="content-26"><p>Certainly! Alcohols are a great functional group to start with since they're familiar in everyday life...</p></div>
        </div>

    </div>
    
    <!-- Modal for adding new message -->
    <div class="modal-overlay" id="addMessageModal">
        <div class="modal">
            <h2>Add New Message</h2>
            <div class="form-group">
                <label for="messageRole">Speaker:</label>
                <select id="messageRole">
                    <option value="user">Student</option>
                    <option value="assistant">Alia</option>
                </select>
            </div>
            <div class="form-group">
                <label for="messageContent">Message:</label>
                <textarea id="messageContent" placeholder="Enter message text..."></textarea>
            </div>
            <div class="modal-buttons">
                <button class="cancel-button" onclick="closeAddModal()">Cancel</button>
                <button class="save-button" onclick="saveNewMessage()">Add Message</button>
            </div>
        </div>
    </div>
    
    <div class="notification" id="notification">Changes saved!</div>
    
    <footer>
        <p>Generated by Transcript Converter with Editing Support</p>
    </footer>

    <script>
        // Store the original JSON data
        const originalData = JSON.parse(`{"UUID": "42de6a7d-6385-4216-9b07-f7fe7fb021d8", "classid": "conceptual-chemistry-1203", "chat_history": [{"role": "assistant", "content": ": Welcome to Conceptual Academy! I'm Alia, and I'm here to support the learning of core science concepts. Let's get started. How can I help you today?", "image_summary": false, "feedback": null}, {"role": "user", "content": ": Hi Alia. I need to learn about functional groups in organic chemistry for my class. I've always struggled with chemistry in high school, so I'm a bit nervous about this topic.", "image_summary": false, "feedback": null}, {"role": "assistant", "content": ": I understand that feeling, and I'm here to help you build confidence in this area. Let's explore functional groups together. In organic chemistry, we start with hydrocarbons - molecules made of carbon and hydrogen atoms. Carbon atoms can bond to one another and to hydrogen atoms in many ways, which results in an incredibly large number of hydrocarbons. But what makes organic chemistry even more diverse is that carbon atoms can bond to atoms of other elements as well.", "image_summary": false, "feedback": null}, {"role": "user", "content": ": So it's not just carbon and hydrogen in organic molecules?", "image_summary": false, "feedback": null}, {"role": "assistant", "content": ": That's right! In organic chemistry, any atom other than carbon or hydrogen in an organic molecule is called a heteroatom. The prefix \"hetero-\" means \"different from either carbon or hydrogen.\"", "image_summary": false, "feedback": null}, {"role": "user", "content": ": Heteroatom... so that would be like oxygen, nitrogen, or other elements that aren't carbon or hydrogen?", "image_summary": false, "feedback": null}, {"role": "assistant", "content": ": Exactly! You've got it. A hydrocarbon structure can serve as a framework for the attachment of various heteroatoms. This is analogous to a Christmas tree's serving as the scaffolding on which ornaments are hung. Just as the ornaments give character to the tree, heteroatoms give character to an organic molecule. These heteroatoms have profound effects on the properties of an organic molecule.", "image_summary": false, "feedback": null}, {"role": "user", "content": ": Can you give me an example of how a heteroatom changes a molecule? It's hard for me to visualize what that means in practice.", "image_summary": false, "feedback": null}, {"role": "assistant", "content": ": Of course. Consider ethane, C\u2082H\u2086, and ethanol, C\u2082H\u2086O. They differ from each other by only a single oxygen atom. Ethane has a boiling point of -88\u00b0C, making it a gas at room temperature, and it does not dissolve in water very well. Ethanol, by contrast, has a boiling point of +78\u00b0C, making it a liquid at room temperature. It is infinitely soluble in water, and it is the active ingredient of alcoholic beverages.", "image_summary": false, "feedback": null}, {"role": "user", "content": ": Wow, so just adding one oxygen atom can change a gas into a liquid? That's a bigger difference than I expected.", "image_summary": false, "feedback": null}, {"role": "assistant", "content": ": Yes, the impact can be dramatic! Consider further ethylamine, C\u2082H\u2087N, which has a nitrogen atom on the same basic two-carbon framework. This compound is a corrosive, pungent, highly toxic gas\u2014most unlike either ethane or ethanol.", "image_summary": false, "feedback": null}, {"role": "user", "content": ": So ethane, ethanol, and ethylamine all have basically the same carbon structure, but they act completely differently because of the different atoms attached to them?", "image_summary": false, "feedback": null}, {"role": "assistant", "content": ": That's precisely correct. These vast differences exist because of the different heteroatoms they contain. In organic chemistry, it's common for organic chemists to use the letter R to indicate an unspecified hydrocarbon coming off a functional group. For example, an alcohol can be indicated as R\u2014OH, while an ether can be indicated as R\u2014O\u2014R. The R could equal a methyl group, \u2014CH\u2083, an ethyl group, \u2014CH\u2082CH\u2083, or any other group of carbon atoms.", "image_summary": false, "feedback": null}, {"role": "user", "content": ": I think I get it. So R is just a placeholder for whatever carbon chain might be there?", "image_summary": false, "feedback": null}, {"role": "assistant", "content": ": Yes, that's a good way to think about it. Now, organic molecules are classified according to the functional groups they contain. We define a functional group as a combination of atoms that behave as a single unit. Most functional groups are distinguished by the heteroatoms they contain.", "image_summary": false, "feedback": null}, {"role": "user", "content": ": So what are some common functional groups? I've heard of alcohols, but I'm not sure what makes something an alcohol.", "image_summary": false, "feedback": null}, {"role": "assistant", "content": ": There are several common functional groups in organic molecules. For alcohols, the functional group is the hydroxyl group, which is an oxygen atom bonded to a hydrogen atom (\u2014OH). Other examples include:\n\n- Ethers, which have an oxygen connecting two carbon groups (R\u2014O\u2014R)\n- Amines, which contain a nitrogen atom connected to carbon atoms and hydrogen atoms\n- Aldehydes and ketones, which contain a carbon-oxygen double bond (C=O)\n- Carboxylic acids, which have the \u2014COOH group\n- Esters, which are derived from carboxylic acids and alcohols\n\nWhen an organic chemist looks at an organic molecule, the first thing they look for are the various functional groups that the organic molecule may contain. This helps them to quickly classify the molecule and to ascertain the various physical, chemical, and even biological properties it might have.", "image_summary": false, "feedback": null}, {"role": "user", "content": ": That seems like a lot to learn! How am I supposed to remember all these different groups?", "image_summary": false, "feedback": null}, {"role": "assistant", "content": ": Don't worry - we'll take it step by step. The remainder of this material introduces these classes of organic molecules. The role heteroatoms play in determining the properties of each class is the underlying theme. As you study this material, focus on understanding the chemical and physical properties of the various classes of compounds. This will give you a greater appreciation of the remarkable diversity of organic molecules and their many applications.", "image_summary": false, "feedback": null}, {"role": "user", "content": ": So if I understand how the heteroatoms affect the properties, then I can make better sense of why organic molecules behave the way they do?", "image_summary": false, "feedback": null}, {"role": "assistant", "content": ": That's absolutely right! While the chemistry of hydrocarbons is interesting, when you start adding heteroatoms to these organic molecules, the chemistry becomes extraordinarily interesting. In fact, the organic chemicals of living organisms all contain heteroatoms.", "image_summary": false, "feedback": null}, {"role": "user", "content": ": Oh, so that's why this matters for biology too? I'm actually more interested in biology than chemistry, so that makes this seem more relevant.", "image_summary": false, "feedback": null}, {"role": "assistant", "content": ": Yes! That's an excellent connection. The significance of heteroatoms in an organic molecule is that they largely determine an organic molecule's physical and chemical properties. And these properties are crucial in biological systems. Your body is full of organic molecules with various functional groups performing specific tasks based on their chemical properties.", "image_summary": false, "feedback": null}, {"role": "user", "content": ": That makes more sense now. So by learning about functional groups, I'm actually learning about why biological molecules work the way they do. I'm still nervous about all the details, but at least I can see why this matters.", "image_summary": false, "feedback": null}, {"role": "assistant", "content": ": That's a great attitude! Understanding the \"why\" behind the concepts often makes learning the details much easier. Would you like to explore any specific functional group in more detail, or shall we continue with the overview of organic molecule classifications?", "image_summary": false, "feedback": null}, {"role": "user", "content": ": I think I'm starting to get comfortable with the basic idea of functional groups. Could we go over alcohols a bit more? Since you mentioned ethanol earlier, and that's something I'm familiar with.", "image_summary": false, "feedback": null}, {"role": "assistant", "content": ": Certainly! Alcohols are a great functional group to start with since they're familiar in everyday life...", "image_summary": false, "feedback": null}], "version": "1.0", "utc_timestamp": 1742538796.369783, "full_hash": ""}`);

        // Store the original file path
        const originalFilePath = "C:\\Users\\sucho\\OneDrive\\Desktop\\Delphi\\clients\\conceptual academy\\aim\\data\\output\\CAC1203_transcript.json";

    
        // Clone the data for modifications
        let currentData = JSON.parse(JSON.stringify(originalData));
        
        // Track if changes have been made
        let hasChanges = false;
        
        // Editing functions
        function editMessage(index) {
            const contentElement = document.getElementById(`content-${index}`);
            const messageElement = contentElement.closest('.message');
            const role = messageElement.dataset.role;
            
            // Store the original content for cancellation
            contentElement.dataset.original = contentElement.innerHTML;
            
            // Make content editable
            contentElement.contentEditable = true;
            contentElement.classList.add('editing');
            contentElement.focus();
            
            // Replace edit button with save/cancel buttons
            const buttonsContainer = messageElement.querySelector('.edit-buttons');
            buttonsContainer.innerHTML = `
                <button class="save-button" onclick="saveMessage(${index})">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                        <polyline points="17 21 17 13 7 13 7 21"></polyline>
                        <polyline points="7 3 7 8 15 8"></polyline>
                    </svg>
                    Save
                </button>
                <button class="cancel-button" onclick="cancelEdit(${index})">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                    Cancel
                </button>
            `;
        }
        
        function saveMessage(index) {
            const contentElement = document.getElementById(`content-${index}`);
            const messageElement = contentElement.closest('.message');
            
            // Get the edited content
            let rawContent = contentElement.innerHTML;
            
            // Update the data
            let content = convertToPlainText(rawContent);
            
            // Update the internal data structure
            currentData.chat_history[index].content = content;
            
            // Make non-editable again
            contentElement.contentEditable = false;
            contentElement.classList.remove('editing');
            
            // Restore edit button
            const buttonsContainer = messageElement.querySelector('.edit-buttons');
            buttonsContainer.innerHTML = `
                <button class="edit-button" onclick="editMessage(${index})">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                        <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                    </svg>
                    Edit
                </button>
            `;
            
            // Show notification
            showNotification("Message saved!");
            hasChanges = true;
        }
        
        function cancelEdit(index) {
            const contentElement = document.getElementById(`content-${index}`);
            const messageElement = contentElement.closest('.message');
            
            // Restore original content
            contentElement.innerHTML = contentElement.dataset.original;
            
            // Make non-editable again
            contentElement.contentEditable = false;
            contentElement.classList.remove('editing');
            
            // Restore edit button
            const buttonsContainer = messageElement.querySelector('.edit-buttons');
            buttonsContainer.innerHTML = `
                <button class="edit-button" onclick="editMessage(${index})">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                        <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                    </svg>
                    Edit
                </button>
            `;
        }
        
        // Add new message functions
        document.getElementById('addMessageButton').addEventListener('click', function() {
            document.getElementById('addMessageModal').style.display = 'flex';
        });
        
        function closeAddModal() {
            document.getElementById('addMessageModal').style.display = 'none';
            document.getElementById('messageContent').value = '';
        }
        
        function saveNewMessage() {
            const role = document.getElementById('messageRole').value;
            const content = document.getElementById('messageContent').value;
            
            if (!content.trim()) {
                alert('Please enter a message.');
                return;
            }
            
            // Add to data structure
            const newMessage = {
                role: role,
                content: content,
                image_summary: false,
                feedback: null
            };
            
            currentData.chat_history.push(newMessage);
            
            // Add to UI
            const chatContainer = document.getElementById('chatContainer');
            const index = currentData.chat_history.length - 1;
            
            const formattedContent = content
                .split('\n\n')
                .filter(p => p.trim())
                .map(p => `<p>${p}</p>`)
                .join('');
            
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${role}`;
            messageDiv.dataset.index = index;
            messageDiv.dataset.role = role;
            
            const roleDisplay = role === 'user' ? 'Student' : 'Alia';
            
            messageDiv.innerHTML = `
                <div class="role">
                    <span>${roleDisplay}</span>
                    <div class="edit-buttons">
                        <button class="edit-button" onclick="editMessage(${index})">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                            </svg>
                            Edit
                        </button>
                    </div>
                </div>
                <div class="content" id="content-${index}">${formattedContent}</div>
            `;
            
            chatContainer.appendChild(messageDiv);
            
            // Close modal and clear form
            closeAddModal();
            
            // Show notification
            showNotification("Message added!");
            hasChanges = true;
            
            // Scroll to the new message
            messageDiv.scrollIntoView({ behavior: 'smooth' });
        }
        
        // Helper functions
        function convertToPlainText(html) {
            // Convert HTML back to plain text format appropriate for the JSON
            let text = html
                .replace(/<div class="reference"><strong>(.*?)<\/strong>(.*?)<\/div>/g, '[Referencing $1$2]')
                .replace(/<pre class="code-block"><code>(.*?)<\/code><\/pre>/gs, '```\n$1\n```')
                .replace(/<p>(.*?)<\/p>/g, '$1\n\n')
                .replace(/<br>/g, '\n');
            
            // Clean up any remaining HTML tags
            text = text.replace(/<[^>]*>/g, '');
            
            // Trim excess whitespace and ensure proper paragraph breaks
            text = text.replace(/\n{3,}/g, '\n\n').trim();
            
            return text;
        }
        
        function showNotification(message) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        // Export JSON function
        document.getElementById('exportButton').addEventListener('click', function() {
            if (!hasChanges && confirm('No changes have been made. Export original file anyway?') === false) {
                return;
            }
            
            // Update timestamp
            currentData.utc_timestamp = Date.now() / 1000;
            
            // Create downloadable file
            const jsonString = JSON.stringify(currentData, null, 2);
            const blob = new Blob([jsonString], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            const filename = originalFilePath.split('/').pop().split('\\').pop();
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            
            setTimeout(() => {
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);
            }, 0);
            
            showNotification("JSON exported!");
        });
        
        // Handle beforeunload to warn about unsaved changes
        window.addEventListener('beforeunload', function(e) {
            if (hasChanges) {
                const message = 'You have unsaved changes. Are you sure you want to leave?';
                e.returnValue = message;
                return message;
            }
        });
    </script>
</body>
</html>
